(function(t){function e(e){for(var n,o,i=e[0],l=e[1],c=e[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,i=1;i<a.length;i++){var l=a[i];0!==r[l]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},r={index:0},s=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},2:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-main",[a("v-container",[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:"12"}},[a("Steps",{attrs:{step:t.step}})],1)],1),a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:"12"}},[a(t.pages[t.step-1],{tag:"component",attrs:{allowedGrades:t.allowedGrades},on:{back:function(e){1==t.step?t.step=3:t.step--},next:function(e){3==t.step?t.step=1:t.step++}}})],1)],1)],1)],1)],1)},s=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("create-noteboard-dialog",{attrs:{hasData:t.hasData,initDates:t.dates},on:{create:t.onNewBoardCreate,update:t.onBoardUpdate,delete:t.onBoardDelete}}),t.hasData?a("comfirmation-dialog",{attrs:{maxWidth:"500px",yesText:"Ja, Änderungen verwerfen",activatorText:"Importieren"},on:{accept:function(e){return t.$refs.import.click()}}},[a("template",{slot:"content"},[a("v-card-text",{staticClass:"black--text"},[t._v("Wenn Sie einen anderen Bemerkungsbogen importieren, "),a("b",[t._v("verlieren Sie hier alle Daten")]),t._v(", die Sie nicht gespeichert/exportiert haben. ")]),a("v-card-text",{staticClass:"black--text",staticStyle:{"margin-top":"-10px"}},[t._v(" Sind Sie sicher? ")])],1)],2):a("v-btn",{staticClass:"mr-6",on:{click:function(e){return t.$refs.import.click()}}},[t._v("Importieren")]),a("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"import",attrs:{id:"noteboard-file",type:"file"},on:{change:t.onFileImport}}),t.hasData?a("v-btn",{on:{click:t.onFileExport}},[t._v("Exportieren")]):t._e(),a("v-spacer"),a("v-btn",{attrs:{color:"primary",disabled:!t.hasData},on:{click:t.onNextClick}},[t._v("Weiter")])],1),t.hasData?a("v-row",{staticClass:"mt-10",attrs:{justify:"space-between"}},t._l(t.terms,(function(e,n){return a("v-col",{key:n,attrs:{cols:"12",sm:"6"}},[a("v-list",[a("v-subheader",{staticClass:"text-h5 font-weight-bold black--text"},[t._v(" "+t._s(n+1)+". Abschnitt ")]),a("v-subheader",{staticStyle:{"margin-top":"-15px"}},[t._v(t._s(t.dateUtils.toGermanDateFormat(e.termBegin))+" - "+t._s(t.dateUtils.toGermanDateFormat(e.termEnd)))]),t._l(e.days,(function(e){return a("v-responsive",{key:t.getDayUID(e),staticClass:"fill-height",attrs:{"min-height":"100",color:"transparent"}},[a("v-lazy",{attrs:{options:{threshold:.5},transition:"fade-transition"}},[a("v-list-item",{attrs:{fluid:""}},[a("daynote-entry",{staticStyle:{width:"100%"},attrs:{date:e.date,initNotes:e.entries,allowedGrades:t.allowedGrades},on:{update:function(a){return t.onNoteUpdate(e.date,a)}}})],1)],1)],1)}))],2)],1)})),1):a("v-row",{staticClass:"mt-10",attrs:{justify:"space-between"}},[t._l(2,(function(e){return a("v-col",{key:e,attrs:{cols:"12",sm:"6"}},[a("v-subheader",{staticClass:"text-h5 font-weiht-bold"},[t._v(" "+t._s(e)+". Abschnitt ")]),a("v-skeleton-loader",{staticClass:"mx-4 mb-3",staticStyle:{width:"250px"},attrs:{type:"text",boilerplate:""}}),a("v-skeleton-loader",{staticClass:"mx-4 gradient-out",attrs:{type:"image",boilerplate:""}})],1)})),a("v-col",{staticClass:"text-center",staticStyle:{"margin-top":"-100px"},attrs:{cols:"12"}},[a("span",{staticClass:"text-h5 grey--text font-weight-black text--darken-2"},[t._v("Bemerkungsbogen neu erstellen oder von einer Datei importieren")])])],2)],1)},i=[],l=a("1da1"),c=(a("e9c4"),a("99af"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("bf19"),a("a15b"),a("d81d"),a("96cf"),a("498a"),{toWeekdayAndFullDate:function(t){return t.toLocaleDateString("de-de",{weekday:"short",year:"numeric",month:"long",day:"2-digit"})},toGermanDateFormat:function(t){return t.toLocaleDateString("de-de",{year:"numeric",month:"long",day:"2-digit"})},toNormalString:function(t){return"".concat(t.getFullYear(),"-").concat(t.getMonth()<9?"0":"").concat(t.getMonth()+1,"-").concat(t.getDate()<10?"0":"").concat(t.getDate())},isDateBetween:function(t,e,a){return t.getFullYear()>=e.getFullYear()&&t.getMonth()>=e.getMonth()&&t.getDate()>=e.getDate()&&t.getFullYear()<=a.getFullYear()&&t.getMonth()<=a.getMonth()&&t.getDate()<=a.getDate()},validateCourseDates:function(t){for(var e=[],a=0;a<t.length;a++)e.push({start:!0,end:!0});for(var n=0;n<t.length;n++){var r=t[n];r.start&&r.start.trim()||(e[n].start="erforderlich"),r.end&&r.end.trim()||(e[n].end="erforderlich",console.log(n))}for(var s=0;s<t.length;s++){var o=t[s],i=new Date(o.start),l=new Date(o.end);i.getTime()>=l.getTime()&&(!0===e[s].start&&(e[s].start=""),e[s].end="ungültiges Datum (zu klein)")}var c=new Date(t[0].end),u=new Date(t[1].start);return c.getTime()>=u.getTime()&&(!0===e[0].end&&(e[0].end=""),e[1].start="ungültiges Datum (zu klein)"),e}}),u=c,d=a("d4ec"),p=a("bee2"),h=(a("4ec9"),a("c1f9"),a("d9e2"),a("4e827"),a("a434"),a("159b"),a("4fadc"),function(){function t(e,a,n,r){Object(d["a"])(this,t),this.term1Begin=e,this.term1End=a,this.term2Begin=n,this.term2End=r,this.entries=new Map,this.holidays=[]}return Object(p["a"])(t,[{key:"toJSON",value:function(){return{term1Begin:this.term1Begin,term1End:this.term1End,term2Begin:this.term2Begin,term2End:this.term2End,holidays:this.holidays,entries:Object.fromEntries(this.entries)}}},{key:"setHoliday",value:function(t,e,a){if(this.holidays.length<=t)throw new Error("Plan.setHoliday: invalid id");t<0?this.holidays.push([e,a]):this.holidays[t]=[e,a],this.holidays.sort((function(t,e){return t[0]-e[0]}))}},{key:"removeHoliday",value:function(t){this.holidays.splice(t,1)}},{key:"setTerms",value:function(t,e,a,n){this.term1Begin=t,this.term1End=e,this.term2Begin=a,this.term2End=n}}],[{key:"fromJSON",value:function(e){var a=e;if(!(a&&a.term1Begin&&a.term1End&&a.term2Begin&&a.term2End&&a.holidays&&a.entries))throw new Error("Plan.fromJSON: invalid json"+e);var n=new t(new Date(a.term1Begin),new Date(a.term1End),new Date(a.term2Begin),new Date(a.term2End));return a.holidays.forEach((function(t){return n.setHoliday(-1,new Date(t[0]),new Date(t[1]))})),n.entries=new Map(Object.entries(e.entries)),n}}]),t}()),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"max-width":"750px",persistent:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,r=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"mr-6",attrs:{color:t.activatorColor}},"v-btn",r,!1),n),[t._v(t._s(t.activatorTitle))])]}},{key:"default",fn:function(e){return[a("v-card",[a("v-card-title",[t._v(t._s(t.title))]),a("v-container",{staticClass:"pl-8 mt-7 mb-2",attrs:{fluid:""}},t._l(t.dates,(function(e,n){return a("v-row",{key:n,staticClass:"pb-5 px-6",attrs:{align:"center"}},[a("v-col",{staticClass:"pa-0 pb-6",attrs:{cols:"3"}},[a("span",[t._v(t._s(t.fieldName(n)))])]),a("v-row",{staticClass:"pa-0",attrs:{align:"center",justify:"center"}},[a("v-col",{staticClass:"pa-0",attrs:{cols:"5"}},[a("v-text-field",{attrs:{type:"date",locale:"de",placeholder:"dd.mm.yyyy",label:"Von",rules:[t.validationRules[n].start],error:!0!==t.validationRules[n].start,outlined:"",dense:""},model:{value:e.start,callback:function(a){t.$set(e,"start",a)},expression:"data.start"}})],1),a("v-spacer"),a("v-col",{staticClass:"pa-0",attrs:{cols:"5"}},[a("v-text-field",{attrs:{type:"date",locale:"de",placeholder:"dd.mm.yyyy",label:"Bis",rules:[t.validationRules[n].end],error:!0!==t.validationRules[n].end,outlined:"",dense:""},model:{value:e.end,callback:function(a){t.$set(e,"end",a)},expression:"data.end"}})],1),a("v-col",{staticStyle:{margin:"-22pt 0 0 -5pt"},style:{visibility:t.isLast(n)?"visible":"hidden"},attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:""},on:{click:t.onHolidayAdd}},[a("v-icon",[t._v("mdi-plus-circle")])],1)],1),a("v-col",{staticStyle:{margin:"-22pt 0 0 -10pt"},style:{visibility:t.isLastHoliday(n)?"visible":"hidden"},attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:""},on:{click:t.onHolidayDelete}},[a("v-icon",[t._v("mdi-delete")])],1)],1)],1)],1)})),1),a("v-card-actions",{staticClass:"pr-6 pl-10 pb-6 pt-4"},[t.hasData?a("comfirmation-dialog",{attrs:{activatorText:"Bemerkungsbogen löschen",activatorColor:"error",yesText:"Ja, den Bogen unwiderruflich löschen"},on:{accept:function(a){return t.onBoardDelete(e)}}},[a("template",{slot:"content"},[a("v-card-text",[t._v("Wollen Sie den Bemerkungsbogen wirklich löschen?"),a("b",[t._v(" Das kann nicht rückgängig gamacht werden.")])])],1)],2):t._e(),a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:function(a){return t.onNoteboardChange(e)}}},[t._v("Bestätigen")]),a("div",{staticClass:"px-2"}),a("v-btn",{on:{click:function(t){e.value=!1}}},[t._v("Abbrechen")])],1)],1)]}}])})},v=[],g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"max-width":t.maxWidth},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,r=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"mr-6",attrs:{color:t.activatorColor}},"v-btn",r,!1),n),[t._v(t._s(t.activatorText))])]}},{key:"default",fn:function(e){return[a("v-card",[a("v-card-title",[t._v(t._s(t.title))]),t._t("content",(function(){return[a("v-card-text",{staticClass:"black--text"},[t._v("Sind Sie sicher")])]})),a("v-card-actions",{staticClass:"pb-4"},[a("v-btn",{staticClass:"mr-3",attrs:{color:"error"},on:{click:function(a){t.$emit("accept"),e.value=!1}}},[t._v(t._s(t.yesText))]),a("v-btn",{on:{click:function(a){t.$emit("reject"),e.value=!1}}},[t._v(t._s(t.noText))])],1)],2)]}}],null,!0)})},m=[],y={name:"ComfirmationDialog",props:{maxWidth:{default:"500px",type:String},title:{default:"Warnung",type:String},yesText:{default:"Ja",type:String},noText:{default:"Nein",type:String},activatorText:{required:!0,type:String},activatorColor:{default:"",type:String}},data:function(){return{}},methods:{}},b=y,w=a("2877"),D=a("6544"),x=a.n(D),S=a("8336"),C=a("b0af"),_=a("99d9"),k=a("169a"),N=Object(w["a"])(b,g,m,!1,null,null,null),E=N.exports;x()(N,{VBtn:S["a"],VCard:C["a"],VCardActions:_["a"],VCardText:_["b"],VCardTitle:_["c"],VDialog:k["a"]});var O={name:"CreateNoteboardDialog",components:{ComfirmationDialog:E},props:{hasData:{required:!0,type:Boolean},initDates:{type:Array}},data:function(){return{dates:[],validationRules:[]}},methods:{onNoteboardChange:function(t){this.validate()&&(this.hasData?this.$emit("update",this.dates):this.$emit("create",this.dates),t.value=!1)},validate:function(){for(var t=u.validateCourseDates(this.dates),e=0;e<t.length;e++){var a=t[e];this.$set(this.validationRules,e,a)}for(var n=0;n<t.length;n++){var r=t[n];if(!0!==r.start||!0!==r.end)return!1}return!0},onBoardDelete:function(t){this.$emit("delete"),t.value=!1},onHolidayDelete:function(){this.dates.pop(),this.validationRules.pop()},onHolidayAdd:function(){this.dates.push({start:"",end:""}),this.validationRules.push({start:!0,end:!0})},fieldName:function(t){return t<2?"".concat(t+1,". Abschnitt"):"".concat(t-1,". Ferienphase")},isLast:function(t){return t+1==this.dates.length},isLastHoliday:function(t){return this.isLast(t)&&t>1}},computed:{title:function(){return this.hasData?"Bemerkungsbogen bearbeiten":"Neuer Bemerkungsbogen"},activatorTitle:function(){return this.hasData?"Bearbeiten":"Neu"},activatorColor:function(){return this.hasData?"":"primary"}},watch:{initDates:{immediate:!0,handler:function(){if(this.initDates){this.dates=JSON.parse(JSON.stringify(this.initDates));for(var t=0;this.dates&&t<this.dates.length;t++)this.validationRules.push({start:!0,end:!0})}}}},created:function(){this.hasData?this.dates=JSON.parse(JSON.stringify(this.initDates)):this.dates=[{start:"",end:""},{start:"",end:""},{start:"",end:""}];for(var t=0;t<this.dates.length;t++)this.validationRules.push({start:!0,end:!0})}},B=O,V=a("62ad"),j=a("a523"),T=a("132d"),F=a("0fd9"),A=a("2fa4"),J=a("8654"),L=Object(w["a"])(B,f,v,!1,null,null,null),I=L.exports;x()(L,{VBtn:S["a"],VCard:C["a"],VCardActions:_["a"],VCardText:_["b"],VCardTitle:_["c"],VCol:V["a"],VContainer:j["a"],VDialog:k["a"],VIcon:T["a"],VRow:F["a"],VSpacer:A["a"],VTextField:J["a"]});var R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"mb-2"},[a("v-subheader",[t._v(t._s(t.dateUtils.toWeekdayAndFullDate(t.date)))]),t._l(t.notes,(function(e,n){return a("v-row",{key:n,staticClass:"pa-4"},[a("v-col",{staticClass:"py-0",attrs:{cols:"8"}},[a("v-select",{staticClass:"pa-0",style:[e.grades.length>1?{width:"160px"}:{width:"70pt"}],attrs:{items:t.allowedGrades,multiple:"","hide-details":""},on:{change:function(a){return t.onNoteGradeChange(n,e)}},scopedSlots:t._u([{key:"selection",fn:function(n){var r=n.item,s=n.index;return[s<2?a("v-chip",{staticStyle:{height:"30px"}},[a("span",[t._v(t._s(r))])]):t._e(),2==s?a("span",{staticClass:"text-caption grey--text pl-2"},[t._v("+"+t._s(e.grades.length-2))]):t._e()]}}],null,!0),model:{value:e.grades,callback:function(a){t.$set(e,"grades",a)},expression:"data.grades"}})],1),a("v-spacer"),a("v-col",{staticClass:"text-right pa-0",attrs:{cols:"3"}},[a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.onNoteDelete(n)}}},[a("v-icon",[t._v("mdi-delete")])],1)],1),a("v-col",{staticClass:"py-0",attrs:{cols:"12"}},[a("v-textarea",{attrs:{rows:"1",placeholder:"Notiz","auto-grow":"","hide-details":""},on:{input:function(e){return t.$emit("update",t.notes)}},model:{value:e.content,callback:function(a){t.$set(e,"content",a)},expression:"data.content"}})],1)],1)})),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{text:""},on:{click:t.onNoteCreate}},[t._v("Neuer Eintrag")])],1)],2)},G=[],$=(a("caad"),a("2532"),a("4de4"),{name:"DaynoteEntry",props:{date:Date,initNotes:[],allowedGrades:{default:function(){return["Alle","EF","Q1","Q2"]},type:Array}},data:function(){return{dateUtils:u,prevNotes:[],notes:[]}},methods:{onNoteGradeChange:function(t,e){!this.prevNotes[t].grades.includes("Alle")&&e.grades.includes("Alle")?e.grades=["Alle"]:this.prevNotes[t].grades.includes("Alle")&&e.grades.length>0&&(e.grades=e.grades.filter((function(t){return"Alle"!=t}))),this.$emit("update",this.notes),this.prevNotes=JSON.parse(JSON.stringify(this.notes))},onNoteCreate:function(){this.notes.push({grades:["Alle"],content:""}),this.$emit("update",this.notes),this.prevNotes=JSON.parse(JSON.stringify(this.notes))},onNoteDelete:function(t){this.notes.splice(t,1),this.$emit("update",this.notes),this.prevNotes=JSON.parse(JSON.stringify(this.notes))}},created:function(){this.notes=this.initNotes,this.prevNotes=JSON.parse(JSON.stringify(this.notes))}}),M=$,U=a("cc20"),Y=a("b974"),H=a("e0c7"),K=a("a844"),P=Object(w["a"])(M,R,G,!1,null,null,null),z=P.exports;x()(P,{VBtn:S["a"],VCard:C["a"],VCardActions:_["a"],VChip:U["a"],VCol:V["a"],VIcon:T["a"],VRow:F["a"],VSelect:Y["a"],VSpacer:A["a"],VSubheader:H["a"],VTextarea:K["a"]});var W={name:"Noteboard",components:{DaynoteEntry:z,CreateNoteboardDialog:I,ComfirmationDialog:E},props:{allowedGrades:{default:function(){return["Alle","EF","Q1","Q2"]},type:Array}},data:function(){return{dateUtils:u,hasData:!1,plan:null}},methods:{onFileImport:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.$refs.import.files[0],!a){e.next=9;break}return e.next=4,a.text();case 4:n=e.sent,r=JSON.parse(n),t.plan=h.fromJSON(r),t.hasData=!0,t.updateStorage();case 9:document.getElementById("noteboard-file").value="";case 10:case"end":return e.stop()}}),e)})))()},onFileExport:function(){var t=JSON.stringify(this.generateFullData()),e="Bemerkungsbogen-".concat(this.plan.term1Begin.getYear()+1900,"-").concat(this.plan.term1Begin.getMonth()+1),a=new Blob([t],{type:"application/json"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(a,e);else{var n=window.document.createElement("a");n.href=window.URL.createObjectURL(a,{oneTimeOnly:!0}),n.download=e,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},onNewBoardCreate:function(t){for(var e=new h(new Date(t[0].start),new Date(t[0].end),new Date(t[1].start),new Date(t[1].end)),a=2;a<t.length;a++){var n=t[a];e.setHoliday(-1,new Date(n.start),new Date(n.end))}this.plan=e,this.hasData=!0,this.updateStorage()},onBoardUpdate:function(t){this.plan.setTerms(new Date(t[0].start),new Date(t[0].end),new Date(t[1].start),new Date(t[1].end)),this.plan.holidays=[];for(var e=2;e<t.length;e++){var a=t[e];this.plan.setHoliday(-1,new Date(a.start),new Date(a.end))}this.plan=h.fromJSON(JSON.parse(JSON.stringify(this.plan.toJSON()))),this.updateStorage()},onBoardDelete:function(){this.hasData=!1,this.plan=null,this.updateStorage()},onNoteUpdate:function(t,e){this.plan.entries.set(u.toNormalString(t),e),this.updateStorage()},onNextClick:function(){this.$emit("next")},generateFullData:function(){return this.plan.toJSON()},fetchSavedBoard:function(){this.hasData=!1;var t=localStorage.getItem("kht.noteboard.hasData");if("true"!==t)return!1;var e=localStorage.getItem("kht.noteboard");if(null!==e){var a=JSON.parse(e);return this.plan=h.fromJSON(a),this.hasData=!0,!0}return!1},updateStorage:function(){localStorage.setItem("kht.noteboard.hasData",this.hasData),this.hasData?localStorage.setItem("kht.noteboard",JSON.stringify(this.generateFullData())):localStorage.removeItem("kht.noteboard")},getDayUID:function(t){return"".concat(u.toNormalString(t.date),"_").concat(t.entries.map((function(t){return t.content})).join("-"))}},computed:{dates:function(){if(!this.plan)return null;for(var t=[{start:u.toNormalString(this.plan.term1Begin),end:u.toNormalString(this.plan.term1End)},{start:u.toNormalString(this.plan.term2Begin),end:u.toNormalString(this.plan.term2End)}],e=0;e<this.plan.holidays.length;e++){var a=this.plan.holidays[e];t.push({start:u.toNormalString(a[0]),end:u.toNormalString(a[1])})}return t},terms:function(){var t=this;if(!this.hasData||!this.plan)return[];for(var e=[{termBegin:this.plan.term1Begin,termEnd:this.plan.term1End,days:[]},{termBegin:this.plan.term2Begin,termEnd:this.plan.term2End,days:[]}],a=0;a<2;a++)for(var n=function(n){if(0==n.getDay()||6==n.getDay())return"continue";if(t.plan.holidays.some((function(t){return u.isDateBetween(n,t[0],t[1])})))return"continue";var r={date:new Date(n),entries:t.plan.entries.get(u.toNormalString(n))||[]};e[a].days.push(r)},r=new Date(e[a].termBegin);r<=e[a].termEnd;r.setDate(r.getDate()+1))n(r);return e}},mounted:function(){this.fetchSavedBoard()}},Q=W,Z=(a("62ac"),a("b687")),q=a("8860"),X=a("da13"),tt=a("6b53"),et=a("3129"),at=Object(w["a"])(Q,o,i,!1,null,null,null),nt=at.exports;x()(at,{VBtn:S["a"],VCardText:_["b"],VCol:V["a"],VContainer:j["a"],VLazy:Z["a"],VList:q["a"],VListItem:X["a"],VResponsive:tt["a"],VRow:F["a"],VSkeletonLoader:et["a"],VSpacer:A["a"],VSubheader:H["a"]});var rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-btn",{staticClass:"mr-6",attrs:{color:"primary"},on:{click:function(e){return t.$refs.import.click()}}},[t._v("Importieren")]),a("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"import",attrs:{id:"courselist-file",type:"file"},on:{change:t.onFileImport}}),a("v-spacer"),a("v-btn",{staticClass:"mr-6",on:{click:function(e){return t.$emit("back")}}},[t._v("Zurück")]),a("v-btn",{attrs:{color:"primary",disabled:!t.hasData},on:{click:function(e){return t.$emit("next")}}},[t._v(" Weiter ")])],1),a("v-row",[a("v-col",{staticClass:"mt-6",attrs:{cols:"12"}},[a("v-data-table",{attrs:{headers:t.headers,items:t.frontList,"sort-by":"class","sort-desc":!0,"no-data-text":"Bitte importieren Sie die Kursliste"}})],1)],1)],1)},st=[],ot=a("b85c"),it=(a("25eb"),a("a9e3"),a("369b")),lt=a.n(it),ct={toGradeLists:function(t,e){var a=function(t){var a,n=new Map,r=Object(ot["a"])(t.data);try{for(r.s();!(a=r.n()).done;){var s=a.value;if(s[1]&&s[1].includes("EF")&&(s[1]="EF"),s={class:s[1],teacher:s[2],subject:s[3],day:s[5],hour:s[6]},n.has(s.class)){var o=n.get(s.class);o.has(s.subject)&&!JSON.stringify(o.get(s.subject)).includes(JSON.stringify(s))?o.get(s.subject).push(s):o.set(s.subject,[s])}else n.set(s.class,new Map),n.get(s.class).set(s.subject,[s])}}catch(x){r.e(x)}finally{r.f()}var i,l=[],c=Object(ot["a"])(n);try{for(c.s();!(i=c.n()).done;){var u,d=i.value,p=Object(ot["a"])(d[1]);try{for(p.s();!(u=p.n()).done;){var h,f=u.value,v=[],g=Object(ot["a"])(f[1]);try{for(g.s();!(h=g.n()).done;){for(var m=h.value,y=-1,b=0;b<v.length;b++){var w=v[b][0];w==m.day&&(y=b)}y>=0?8==Number.parseInt(m.hour)?"u"==v[y][1]&&(v[y][1]=""):9==Number.parseInt(m.hour)&&"g"==v[y][1]&&(v[y][1]=""):8==Number.parseInt(m.hour)?v.push([m.day,"g"]):9==Number.parseInt(m.hour)?v.push([m.day,"u"]):v.push([m.day,""])}}catch(x){g.e(x)}finally{g.f()}var D={class:f[1][0].class,teacher:f[1][0].teacher,subject:f[1][0].subject,days:v};D.subject&&l.push(D)}}catch(x){p.e(x)}finally{p.f()}}}catch(x){c.e(x)}finally{c.f()}e.list=n,e.condensedList=l},n=function(t){console.error(t),e.hasData=!1};lt.a.parse(t,{complete:a,error:n})}},ut=ct,dt={name:"Courselist",data:function(){return{hasData:!1,list:new Map,condensedList:[],headers:[{text:"Stufe",value:"class",align:"start"},{text:"Fach",value:"subject"},{text:"Lehrer|In",value:"teacher"},{text:"Wochentage",value:"days"}],frontList:[]}},methods:{onFileImport:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=t.$refs.import.files[0],a&&(ut.toGradeLists(a,t),t.hasData=!0),document.getElementById("courselist-file").value="";case 3:case"end":return e.stop()}}),e)})))()},fetchList:function(){var t=sessionStorage.getItem("kht.courselist.hasData");if("true"===t){var e=sessionStorage.getItem("kht.courselist");e&&(this.condensedList=JSON.parse(e),this.hasData=!0)}else this.hasData=!1},updateStorage:function(){sessionStorage.setItem("kht.courselist.hasData",this.hasData),sessionStorage.setItem("kht.courselist",JSON.stringify(this.condensedList))}},watch:{condensedList:function(){var t=this;console.log("list changed"),this.condensedList.forEach((function(e){var a=JSON.parse(JSON.stringify(e));a.days=a.days.map((function(t){return"".concat(t[0]).concat(""==t[1]?"":" (").concat(""==t[1]?"":t[1]).concat(""==t[1]?"":")")})),a.days=a.days.join(", "),t.frontList.push(a)})),this.updateStorage()}},mounted:function(){this.fetchList()}},pt=dt,ht=a("8fea"),ft=Object(w["a"])(pt,rt,st,!1,null,null,null),vt=ft.exports;x()(ft,{VBtn:S["a"],VCol:V["a"],VContainer:j["a"],VDataTable:ht["a"],VRow:F["a"],VSpacer:A["a"]});var gt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-dialog",{attrs:{"max-width":"700px",persistent:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,r=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"mr-6",attrs:{color:"primary",disabled:t.progress>0&&t.progress<100}},"v-btn",r,!1),n),[t._v("Kurshefte generieren")])]}},{key:"default",fn:function(e){return[a("v-card",[a("v-card-title",[t._v(" Kurshefte Generieren ")]),a("v-container",{staticClass:"pl-8 mt-4",attrs:{fluid:""}},[a("v-row",{staticClass:"pb-1 px-6",attrs:{align:"center"}},[a("v-select",{attrs:{items:t.allowedGrades,rules:[t.gradesToExport.length>0||"Erforderlich"],label:"Stufen zum Exportieren",multiple:""},on:{change:t.onGradesChange},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.item;return[a("v-chip",{staticStyle:{height:"30px"}},[a("span",[t._v(t._s(n))])])]}}],null,!0),model:{value:t.gradesToExport,callback:function(e){t.gradesToExport=e},expression:"gradesToExport"}})],1)],1),a("v-card-actions",{staticClass:"pr-6 pl-10 pb-6 pt-4"},[a("v-spacer"),a("v-btn",{attrs:{color:"primary",disabled:0==t.gradesToExport.length},on:{click:function(a){return t.onGenerate(e)}}},[t._v("Bestätigen")]),a("div",{staticClass:"px-2"}),a("v-btn",{on:{click:function(t){e.value=!1}}},[t._v("Abbrechen")])],1)],1)]}}])}),a("v-btn",{attrs:{disabled:t.progress<0||null==t.res},on:{click:t.onRedownload}},[t._v("Herunterladen")]),a("v-spacer"),a("v-btn",{staticClass:"mr-6",attrs:{disabled:t.progress>=0&&t.progress<100},on:{click:function(e){return t.$emit("back")}}},[t._v("Zurück")])],1),a("v-row",{attrs:{justify:"space-around"}},[a("v-col",{staticClass:"mt-12",attrs:{cols:"10"}},[a("v-progress-linear",{attrs:{value:t.progress,height:"25",color:t.progress>=0?"light-blue":"grey",striped:""}},[a("strong",{staticClass:"grey--text",class:{"text--darken-4":t.progress>=0}},[t._v(t._s(t.progressDisplay))])])],1)],1),a("v-row",{staticClass:"mt-6",attrs:{justify:"space-around"}},[a("v-col",{attrs:{cols:"10"}},[a("v-card",[a("v-card-title",[t._v(" Zusammenfassung ")]),a("v-card-text",[a("p",[t._v(" Zu exportierende Kurse: "+t._s(t.progress>=0?t.exportCount+"/"+t.toExport:"N/A")+" ")]),a("p",[t._v(" Stufen: "+t._s(t.progress>=0?t.gradesToExport.join(", "):"N/A")+" ")]),a("v-container",{attrs:{fluid:""}},t._l(t.dates,(function(e,n){return a("v-row",{key:n},[a("v-col",{staticClass:"pa-0 my-0 mb-4",attrs:{cols:"2"}},[t._v(" "+t._s(t.intervalName(n))+": ")]),a("v-col",{staticClass:"pa-0 my-0 mb-4",attrs:{cols:"10"}},[t._v(" "+t._s(t.dateUtils.toGermanDateFormat(e.start))+" - "+t._s(t.dateUtils.toGermanDateFormat(e.end)))])],1)})),1)],1)],1)],1)],1)],1)},mt=[],yt=(a("ac1f"),a("1276"),a("5319"),a("cb29"),a("31fa")),bt=595.28,wt=841.89;function Dt(t){return!t||t<0||t>100?0:t/100*bt}function xt(t){return!t||t<0||t>100?0:t/100*wt}function St(t,e){var a,n=function(t){t=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));var e=t.getFullYear();t.setUTCDate(t.getUTCDate()+4-(t.getUTCDay()||7));var a=new Date(Date.UTC(t.getUTCFullYear(),0,1)),n=Math.ceil(((t-a)/864e5+1)/7);return t.getUTCFullYear()<e?1:n},r=function(a){var r,s=Object(ot["a"])(t.holidays);try{for(s.s();!(r=s.n()).done;){var o=r.value;if(Nt(a,o[0],o[1]))return!1}}catch(u){s.e(u)}finally{s.f()}var i,l=Object(ot["a"])(e.days);try{for(l.s();!(i=l.n()).done;){var c=i.value;if(c[0]==a.getDay())return("g"!==c[1]||n(a)%2==0)&&("u"!==c[1]||n(a)%2==1)}}catch(u){l.e(u)}finally{l.f()}return!1},s=function(t){var a,n="",r=Object(ot["a"])(t);try{for(r.s();!(a=r.n()).done;){var s=a.value;(s.grades.includes(e.class)||s.grades.includes("Alle"))&&(n+="".concat(s.content,"; "))}}catch(o){r.e(o)}finally{r.f()}return n},o=function(t,e){var a=t.split(".").map((function(t){return Number.parseInt(t)})),n=e.split(".").map((function(t){return Number.parseInt(t)}));return new Date(a[2],a[1]-1,a[0])-new Date(n[2],n[1]-1,n[0])},i=[],l=Object(ot["a"])(t.holidays);try{for(l.s();!(a=l.n()).done;){var c=a.value;i.push({day:c[0].toLocaleDateString("de-de",{weekday:"short"}),date:Ot(c[0]),note:"Ferien bis ".concat(Ot(c[1]))})}}catch(p){l.e(p)}finally{l.f()}for(var u=new Date(t.term1Begin);u<=t.term1End;u.setDate(u.getDate()+1))r(u)&&i.push({day:u.toLocaleDateString("de-de",{weekday:"short"}),date:Ot(u),note:s(t.entries.get(kt(u))||"")});for(var d=new Date(t.term2Begin);d<=t.term2End;d.setDate(d.getDate()+1))r(d)&&i.push({day:d.toLocaleDateString("de-de",{weekday:"short"}),date:Ot(d),note:s(t.entries.get(kt(d))||"")});return i.sort((function(t,e){return o(t.date,e.date)})),i}function Ct(t){return t.getMonth()>5?1:2}function _t(t){var e=t.getFullYear();return 1==Ct(t)?"".concat(e,"/").concat(e+1):"".concat(e-1,"/").concat(e)}function kt(t){return"".concat(t.getFullYear(),"-").concat(t.getMonth()<9?"0":"").concat(t.getMonth()+1,"-").concat(t.getDate()<10?"0":"").concat(t.getDate())}function Nt(t,e,a){return t.getFullYear()>=e.getFullYear()&&t.getMonth()>=e.getMonth()&&t.getDate()>=e.getDate()&&t.getFullYear()<=a.getFullYear()&&t.getMonth()<=a.getMonth()&&t.getDate()<=a.getDate()}function Et(t,e){var a=[],n=["EF","Q1","Q2"].includes(e.class)?e.class:e.class.substring(0,e.class.length-1).replace(/^0+/,"");return a.push("Jahrgangstufe ".concat(n,".").concat(Ct(t.term1Begin),"    ").concat(Ct(t.term1Begin),". Halbjahr ").concat(_t(t.term1Begin))),a.push("Sollstunde für Kurs  ".concat(e.subject,"-").concat(e.teacher,"-").concat(e.class)),a}function Ot(t){return"".concat(t.getDate()<10?"0":"").concat(t.getDate(),".").concat(t.getMonth()<9?"0":"").concat(t.getMonth()+1,".").concat(t.getFullYear())}var Bt=Dt(4),Vt=Dt(43),jt=Dt(100)-2*Bt-2*Vt,Tt=.1*Vt,Ft=.2*Vt,At=xt(1.5),Jt=xt(1.25),Lt=xt(.3),It="#d2d2d2",Rt="#e6e6e6",Gt=[It,Rt],$t="#0",Mt=65,Ut=["Tag","Datum","Besonderheiten"],Yt="Alle Termine dieser Liste müssen in der Kursmappe eingetragen sein, auch die unterrichtsfreien Tage. Alle Termine (außer den Ferien) müssen durch ihre Paraphe bestätigt werden. Tragen Sie bitte auch die Fehlstundenzahl sowie die Soll - Ist - Stunden (Kursheft S.5) ein. \nHinweis: Schüler, die aus schulischen Gründen den Unterricht versäumt haben (Klausur, schul.Veranstaltung usw.) müssen im Kursheft aufgeführt werden. Diese Stunden dürfen auf dem Zeugnis aber nicht als Fehlstunden vermerkt werden.",Ht={create:function(t,e,a,n){return Object(l["a"])(regeneratorRuntime.mark((function r(){var s,o,i,l,c,u,d,p,h,f,v,g,m,y;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:s=new PDFDocument({autoFirstPage:!1,size:"A4"}),o=s.pipe(yt()),i=["".concat(Ot(t.term1Begin)," - ").concat(Ot(t.term1End)),"".concat(Ot(t.term2Begin)," - ").concat(Ot(t.term2End))],l=Object(ot["a"])(e),r.prev=4,l.s();case 6:if((c=l.n()).done){r.next=18;break}for(u=c.value,s.addPage({margin:0,size:"A4"}),d=St(t,u),p=Et(t,u),d.length>Mt&&console.warn("Maximal row limitation ".concat(Mt," exceeded. Actual: ").concat(d.length,".")),h=0;h<2;h++){for(f=0==h?Bt:Bt+Vt+jt,v=f,g=At,s.font("Times-Bold").fontSize(14).text(p[0],v,g),g+=xt(2.2),s.text(p[1],v,g),g+=xt(2.8),s.fontSize(10),s.text(Ut[0],v,g),v+=Tt,s.text(Ut[1],v,g),v+=Ft,s.text(Ut[2],v,g),v=f,g+=Jt+2*Lt,s.fontSize(8),s.font("Times-Roman"),m=0;m<d.length;m++)y=d[m],s.rect(v,g-Lt,Vt,Jt).fill(Gt[m%2]),s.fillColor($t).text(y.day,v,g),v+=Tt,s.text(y.date,v,g),v+=Ft,s.text(y.note,v,g),v=f,g+=Jt;0==h&&(g+=.3*Jt,s.text("1. Kursabschnitt: ".concat(i[0]),v,g),g+=Jt,s.text("2. Kursabschnitt: ".concat(i[1]),v,g),g+=1.1*Jt,s.fontSize(7),s.text(Yt,v,g,{width:Vt,height:wt-g,align:"justify"}))}return a(),r.next=16,new Promise((function(t){return setTimeout(t,25)}));case 16:r.next=6;break;case 18:r.next=23;break;case 20:r.prev=20,r.t0=r["catch"](4),l.e(r.t0);case 23:return r.prev=23,l.f(),r.finish(23);case 26:s.end(),o.on("finish",(function(){n(o.toBlob("application/pdf"))}));case 28:case"end":return r.stop()}}),r,null,[[4,20,23,26]])})))()}},Kt=Ht,Pt={name:"BookExport",props:{allowedGrades:{default:function(){return["Alle","EF","Q1","Q2"]},type:Array}},data:function(){return{dateUtils:u,progress:-1,prevGrades:[],gradesToExport:[],plan:null,courselist:[],res:null,exportCount:0,toExport:0}},methods:{onGradesChange:function(){!this.prevGrades.includes("Alle")&&this.gradesToExport.includes("Alle")?this.gradesToExport=["Alle"]:this.prevGrades.includes("Alle")&&this.gradesToExport.length>0&&(this.gradesToExport=this.gradesToExport.filter((function(t){return"Alle"!=t}))),this.prevGrades=JSON.parse(JSON.stringify(this.gradesToExport))},onGenerate:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.value=!1,window.URL.revokeObjectURL(e.res),e.res=null,n="Alle"==e.gradesToExport?e.allowedGrades:e.gradesToExport,r=e.courselist.filter((function(t){return n.includes(t.class)})),e.exportCount=0,e.toExport=r.length,Kt.create(e.plan,r,(function(){e.exportCount++,e.progress=e.exportCount/e.toExport*100}),(function(t){var a="merged-".concat(e.gradesToExport.join("-"));e.res=window.URL.createObjectURL(t),window.navigator.msSaveOrOpenBlob?window.navigator.msSaveBlob(t,a):e.triggerDownload(a,e.res)}));case 8:case"end":return a.stop()}}),a)})))()},triggerDownload:function(t,e){var a=window.document.createElement("a");a.href=e,a.download=t,a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)},onRedownload:function(){this.triggerDownload("merged-".concat(this.gradesToExport.join("-")),this.res)},fetchData:function(){var t=sessionStorage.getItem("kht.courselist.hasData");if("true"===t){var e=sessionStorage.getItem("kht.courselist");e&&(this.courselist=JSON.parse(e));var a=localStorage.getItem("kht.noteboard.hasData");if("true"===a){var n=localStorage.getItem("kht.noteboard");if(null!==n){var r=JSON.parse(n);this.plan=h.fromJSON(r),this.hasData=!0}}else console.error("No data for noteboard found")}else console.error("No data for courselist found")},intervalName:function(t){return t<2?"".concat(t+1,". Abschnitt"):"".concat(t-1,". Ferienphase")}},computed:{progressDisplay:function(){return this.progress<0?'"Kurshefte Generieren" Klicken':Math.ceil(this.progress)},dates:function(){if(!this.plan)return null;for(var t=[{start:this.plan.term1Begin,end:this.plan.term1End},{start:this.plan.term2Begin,end:this.plan.term2End}],e=0;e<this.plan.holidays.length;e++){var a=this.plan.holidays[e];t.push({start:a[0],end:a[1]})}return t}},mounted:function(){this.fetchData(),this.gradesToExport=["Alle"],this.prevGrades=["Alle"]}},zt=Pt,Wt=a("8e36"),Qt=Object(w["a"])(zt,gt,mt,!1,null,null,null),Zt=Qt.exports;x()(Qt,{VBtn:S["a"],VCard:C["a"],VCardActions:_["a"],VCardText:_["b"],VCardTitle:_["c"],VChip:U["a"],VCol:V["a"],VContainer:j["a"],VDialog:k["a"],VProgressLinear:Wt["a"],VRow:F["a"],VSelect:Y["a"],VSpacer:A["a"]});var qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-stepper",{model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.step>1,step:"1",color:t.step>1?"grey":"primary"}},[t._v(" Bemerkungsbogen ausfüllen ")]),a("v-divider"),a("v-stepper-step",{attrs:{complete:t.step>2,step:"2",color:t.step>2?"grey":"primary"}},[t._v(" Kursliste importieren ")]),a("v-divider"),a("v-stepper-step",{attrs:{complete:t.step>3,step:"3",color:t.step>3?"grey":"primary"}},[t._v(" Kurshefte generieren ")])],1)],1)},Xt=[],te={name:"Steps",props:{step:Number},data:function(){return{}}},ee=te,ae=a("ce7e"),ne=a("7e85"),re=a("9c54"),se=a("56a4"),oe=Object(w["a"])(ee,qt,Xt,!1,null,null,null),ie=oe.exports;x()(oe,{VDivider:ae["a"],VStepper:ne["a"],VStepperHeader:re["a"],VStepperStep:se["a"]});var le={name:"App",components:{Noteboard:nt,Steps:ie,Courselist:vt,BookExport:Zt},data:function(){return{step:1,pages:["Noteboard","Courselist","BookExport"],allowedGrades:["Alle","EF","Q1","Q2"]}}},ce=le,ue=a("7496"),de=a("f6c4"),pe=Object(w["a"])(ce,r,s,!1,null,null,null),he=pe.exports;x()(pe,{VApp:ue["a"],VCol:V["a"],VContainer:j["a"],VMain:de["a"],VRow:F["a"]});var fe=a("f309"),ve=a("2657");n["a"].use(fe["a"]);var ge=new fe["a"]({lang:{locales:{de:ve["a"]},current:"de"}});n["a"].config.productionTip=!1,new n["a"]({vuetify:ge,render:function(t){return t(he)}}).$mount("#app")},"62ac":function(t,e,a){"use strict";a("b629")},b629:function(t,e,a){}});
//# sourceMappingURL=index.f63f53c7.js.map